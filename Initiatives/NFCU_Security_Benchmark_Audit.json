{
    "name": "SecBenchmarkAudit",
    "properties": {
        "displayName": "NFCU Security Benchmark Audit",
        "description": "This initiative contains Data privacy and Protection policies involving Logging, Data transfers, Versioning and recoverability security controls for Azure Resources.",
        "metadata": [
            {
                "category": "Security Benchmark",
                "version": "1.0"
            }
        ],
        "policyDefinitionGroups": [
            {
                "name": "Protect and Secure Data Privacy and Protection"
            },
            {
                "name": "Protect and Secure Digital Identity"
            },
            {
                "name": "Protect and Secure Network and Endpoint Security"
            },
            {
                "name": "Manage and Govern Application Security"
            },
            {
                "name": "Visibility and Monitoring Cyber Defense"
            }
        ],
        "parameters": {
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "AuthenticationshouldbeenabledonyourFunctionapp",
                "policyDefinitionName": "c75248c1-ea1d-4a9c-8fc9-29a6aabd5da8",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Digital Identity"
                ]
            },
            {
                "policyDefinitionReferenceId": "AuthenticationshouldbeenabledonyourAPIapp",
                "policyDefinitionName": "c4ebc54a-46e1-481a-bee2-d4411e95d828",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Digital Identity"
                ]
            },
            {
                "policyDefinitionReferenceId": "AuthenticationshouldbeenabledonyourWebapp",
                "policyDefinitionName": "95bccee9-a7f8-4bec-9ee9-62c3473701fc",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Digital Identity"
                ]
            },
            {
                "policyDefinitionReferenceId": "ManagedIdentitysecuresettingsV1.0",
                "policyDefinitionName": "Managed Identity secure settings v1.0",
                "parameters": {
                  "identity.type.value": {
                    "value": [
                      "SystemAssigned"
                    ]
                  }
                },
                "groupnames": [
                    "Protect and Secure Digital Identity"
                ]
            },
            {
                "policyDefinitionReferenceId": "RedisCacheSecureSettingsv1.0",
                "policyDefinitionName": "Redis Cache secure settings v1.0",
                "parameters": {
                    "minimumTlsVersion": {
                        "value": [
                            "1.2"
                        ]
                    },
                    "enableNonSslPort": {
                        "value": [
                            true
                        ]
                    }
                },
                "groupnames": [
                    "Manage and Govern Application Security"
                ]
            },
            {
                "policyDefinitionReferenceId": "RemotedebuggingshouldbeturnedoffforAPIApps",
                "policyDefinitionName": "e9c8d085-d9cc-4b17-9cdc-059f1f01f19e",
                "parameters": {},
                "groupnames": [
                    "Manage and Govern Application Security"
                ]
            },
            {
                "policyDefinitionReferenceId": "RemotedebuggingshouldbeturnedoffforFunctionApps",
                "policyDefinitionName": "0e60b895-3786-45da-8377-9c6b4b6ac5f9",
                "parameters": {},
                "groupnames": [
                    "Manage and Govern Application Security"
                ]
            },
            {
                "policyDefinitionReferenceId": "RemotedebuggingshouldbeturnedoffforWebApplications",
                "policyDefinitionName": "cb510bfd-1cba-4d9f-a230-cb0976f4bb71",
                "parameters": {},
                "groupnames": [
                    "Manage and Govern Application Security"
                ]
            },
            {
                "policyDefinitionReferenceId": "AllauthorizationrulesexceptRootManageSharedAccessKeyshouldberemovedfromEventHubnamespace",
                "policyDefinitionName": "b278e460-7cfc-4451-8294-cccc40a940d7",
                "parameters": {},
                "groupnames": [
                    "Manage and Govern Application Security"
                ]
            },
            {
                "policyDefinitionReferenceId": "AllauthorizationrulesexceptRootManageSharedAccessKeyshouldberemovedfromServiceBusnamespace",
                "policyDefinitionName": "a1817ec0-a368-432a-8057-8371e17ac6ee",
                "parameters": {},
                "groupnames": [
                    "Manage and Govern Application Security"
                ]
            },
            {
                "policyDefinitionReferenceId": "APIAppshouldonlybeaccessibleoverHTTPS",
                "policyDefinitionName": "b7ddfbdc-1260-477d-91fd-98bd9be789a6",
                "parameters": {},
                "groupnames": [
                    "Manage and Govern Application Security"
                ]
            },
            {
                "policyDefinitionReferenceId": "FunctionAppshouldonlybeaccessibleoverHTTPS",
                "policyDefinitionName": "6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
                "parameters": {},
                "groupnames": [
                    "Manage and Govern Application Security"
                ]
            },
            {
                "policyDefinitionReferenceId": "EnsureAPIapphas'ClientCertificates(Incomingclientcertificates)'setto'On'",
                "policyDefinitionName": "0c192fe8-9cbb-4516-85b3-0ade8bd03886",
                "parameters": {},
                "groupnames": [
                    "Manage and Govern Application Security"
                ]
            },
            {
                "policyDefinitionReferenceId": "Ensure WEB app has 'Client Certificates (Incoming client certificates)' set to 'On'",
                "policyDefinitionName": "5bb220d9-2698-4ee4-8404-b9c30c9df609",
                "parameters": {},
                "groupnames": [
                    "Manage and Govern Application Security"
                ]
            },
            {
                "policyDefinitionReferenceId": "EnsureFunctionapphas'ClientCertificates(Incomingclientcertificates)'setto'On'",
                "policyDefinitionName": "eaebaea7-8013-4ceb-9d14-7eb32271373c",
                "parameters": {},
                "groupnames": [
                    "Manage and Govern Application Security"
                ]
            },
            {
                "policyDefinitionReferenceId": "DiagnosticLogssecuresettingsV1.0",
                "policyDefinitionName": "Diagnostic Logs secure settings v1.0",
                "parameters": {
                  "eventHubAuthorizationRuleId": {
                    "value": [
                      true
                    ]
                  },
                  "storageAccountId": {
                    "value": [
                      true
                    ]
                  },
                  "workspaceId": {
                    "value": [
                      true
                    ]
                  },
                  "resourceTypes": {
                    "value": [
                      "Microsoft.DataFactory/factories",
                      "Microsoft.DataLakeStore/accounts",
                      "Microsoft.Network/applicationGateways",
                      "Microsoft.KeyVault/vaults",
                      "Microsoft.RecoveryServices/vaults",
                      "Microsoft.Databricks/workspaces",
                      "Microsoft.Compute/virtualMachineScaleSets",
                      "Microsoft.Network/FrontDoorWebApplicationFirewallPolicies",
                      "Microsoft.Web/sites"
                    ]
                  }
                },
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "SQLServerVersionSettingsV1.0",
                "policyDefinitionName": "SQL Server Version Settings v1.0",
                "parameters": {
                  "version": {
                    "value": [
                      "12.0"
                    ]
                  }
                },
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "KeyVaultSecureSettingV1.0",
                "policyDefinitionName": "Key Vault Secure Settings v1.0",
                "parameters": {
                  "enabledForDeployment": {
                    "value": [
                      true,
                      false
                    ]
                  },
                  "enableSoftDelete": {
                    "value": [
                      true
                    ]
                  },
                  "enabledForTemplateDeployment": {
                    "value": [
                      true,
                      false
                    ]
                  },
                  "enabledForDiskEncryption": {
                    "value": [
                      true,
                      false
                    ]
                  },
                  "enablePurgeProtection": {
                    "value": [
                      true
                    ]
                  }
                },
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "Geo-redundantstorageshouldbeenabledforStorageAccounts",
                "policyDefinitionName": "bf045164-79ba-4215-8f95-f8048dc1780b",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "SoftDeleteonBlobStorageaccountsv2.0",
                "policyDefinitionName": "Soft Delete on Blob Storage accounts v2.0",
                "parameters": {
                  "retentionDays": {
                    "value": 90
                  }
                },
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "AdvanceddatasecurityshouldbeenabledonyourSQLServers",
                "policyDefinitionName": "abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "AnAzureActiveDirectoryadministratorshouldbeprovisionedforSQLservers",
                "policyDefinitionName": "1f314764-cb73-4fc9-b863-8eca98ac36e9",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "Automationaccountvariablesshouldbeencrypted",
                "policyDefinitionName": "3657f5a0-770e-44a3-b44e-9431ba1e9735",
                "Name": "Automation account variables should be encrypted",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "AzureDefenderforStorageshouldbeenabled",
                "policyDefinitionName": "308fbb08-4ab8-4e67-9b29-592e93fb94fa",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "RequireStorageFileEncryption",
                "policyDefinitionName": "4c23139d-014f-400b-8417-d67918b8b9ba",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "Securetransfertostorageaccountsshouldbeenabled",
                "policyDefinitionName": "404c3081-a854-4457-ae30-26a93ef643f9",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "TransparentDataEncryptiononSQLdatabasesshouldbeenabled",
                "policyDefinitionName": "17k78e20-9358-41c9-923c-fb736d382a12",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "VulnerabilityassessmentshouldbeenabledonSQLManagedInstance",
                "policyDefinitionName": "1b7aa243-30e4-4c9e-bca8-d0d3022b634a",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "RequireEncryptiononStorageAccounts",
                "policyDefinitionName": "e594e3ce-925e-4a68-837e-7badda9e54fa",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "AuditingonSQLservershouldbeenabled",
                "policyDefinitionName": "a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
                "parameters": {
                  "setting": {
                    "value": "enabled"
                  }
                },
                "groupnames": [
                    "Protect and Secure Data Privacy and Protection"
                ]
              },
              {
                "policyDefinitionReferenceId": "MySQLSSLEnforcementSettingsV1.0",
                "policyDefinitionName": "MySQL SSL Enforcement Settings v1.0",    
                "parameters": {
                  "sslEnforcement": {
                    "value": [
                      "Enabled"
                    ]
                  }
                },
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "SQLManagedInstancessecuresettingsV1.0",
                "policyDefinitionName": "SQL Managed Instances secure settings v1.0",
                "parameters": {
                  "publicDataEndpointEnabled": {
                    "value": [
                      true
                    ]
                  }
                },
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "VirtualNetworksecuresettingsV1.0",
                "policyDefinitionName": "Virtual Network secure settings v1.0",   
                "parameters": {
                  "enableDdosProtection": {
                    "value": [
                      true
                    ]
                  },
                  "subnets.star.name": {
                    "value": [
                      "default",
                      "GatewaySubnet",
                      "AzureFirewallSubnet",
                      "ALL"
                    ]
                  },
                  "subnets.star.networkSecurityGroup": {
                    "value": [
                      false
                    ]
                  }
                },
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "CosmosDBshoulduseavirtualnetworkserviceendpoint",
                "policyDefinitionName": "e0a2b1a3-f7f9-4569-807f-2a9edebdf4d9",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "KeyVaultshoulduseavirtualnetworkserviceendpoint",
                "policyDefinitionName": "ea4d6841-2173-4317-9747-ff522a45120f",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "RDPaccessfromtheInternetshouldbeblocked",
                "policyDefinitionName": "e372f825-a257-4fb8-9175-797a8a8627d6",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "SSHaccessfromtheInternetshouldbeblocked",
                "policyDefinitionName": "2c89a2e5-7285-40fe-afe0-ae8654b92fab",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "NetworkApplicationGatewaySecureSettingsV1.0",
                "policyDefinitionName": "Network Application Gateway Secure Settings v1.0",
                "parameters": {
                  "webApplicationFirewallConfiguration.enabled": {
                    "value": [
                      true
                    ]
                  },
                  "sku.tier": {
                    "value": [
                      "WAF",
                      "WAF_v2"
                    ]
                  },
                  "webApplicationFirewallConfiguration.firewallMode": {
                    "value": [
                      "Prevention"
                    ]
                  }
                },
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "NetworkWatchershouldbeenabled",
                "policyDefinitionName": "b6e2945c-0b7b-40f5-9233-7a5323b5cdc6",
                "parameters": {
                  "resourcegroupname": {
                    "value": "NetworkWatcherRG"
                  },
                  "listOfLocations": {
                    "value": [
                      "East US",
                      "South Central US"
                    ]
                  }
                },
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "PrivateendpointenabledforMySQLserversV1.0",
                "policyDefinitionName": "Private endpoint enabled for MySQL servers v1.0",
                "parameters": {
                  "PrivateEndpoint_vNet": {
                    "value": "NA"
                  }
                },
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "LatestTLSversionshouldbeusedinyourFunctionApp",
                "policyDefinitionName": "f9d614c5-c173-4d56-95a7-b4437057d193",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "LatestTLSversionshouldbeusedinyourWebApp",
                "policyDefinitionName": "f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "AppServiceshoulduseavirtualnetworkserviceendpoint",
                "policyDefinitionName": "2d21331d-a4c2-4def-a9ad-ee4e1e023beb",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "NetworkinterfacesshouldnothavepublicIps",
                "policyDefinitionName": "83a86a26-fd1f-447c-b59d-e51f44264114",
                "parameters": {},
                "groupnames": [
                    "Protect and Secure Network and Endpoint Security"
                ]
              },
              {
                "policyDefinitionReferenceId": "CosmosDBSecureSettingsV1.0",
                "policyDefinitionName": "Cosmos DB Secure Settings v1.0",
                "parameters": {
                  "defaultConsistencyLevel": {
                    "value": [
                      "Strong",
                      "BoundedStaleness",
                      "Session",
                      "ConsistentPrefix"
                    ]
                  },
                  "enableAutomaticFailover": {
                    "value": [
                      true
                    ]
                  }
                },
                "groupnames": [
                    "Visibility and Monitoring Cyber Defense"
                ]
              },
              {
                "policyDefinitionReferenceId": "VirtualmachinesshouldbemigratedtonewAzureResourceManagerresources",
                "policyDefinitionName": "1d84d5fb-01f6-4d12-ba4f-4a26081d403d",
                "parameters": {},
                "groupnames": [
                    "Visibility and Monitoring Cyber Defense"
                ]
              },
              {
                "policyDefinitionReferenceId": "AzureBackupshouldbeenabledforVirtualMachines",
                "policyDefinitionName": "013e242c-8828-4970-87b3-ab247555486d",
                "parameters": {},
                "groupnames": [
                    "Visibility and Monitoring Cyber Defense"
                ]
              }
        ]
    }
}